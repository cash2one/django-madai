{% extends 'website/website.base.inc.html' %}
{% load static %}
{% block title %} 小麻袋 {% endblock title %}


{% block extracss %}
<link rel="stylesheet" href="{% static 'package/styles/app.css' %}" media="screen"/>
{% endblock extracss %}

{% block main_content %}
{% include 'website/header.inc.html' %}
<section class="bg-color-dark bg-image-white-light">
  <div class="bottom-shade-large"></div>
  <article class="search-info">
    <div class="middle">
      <h3 class="text-center color-blue">为您推荐精选以下行程 {{ start_address }}出发</h3>
    </div>
  </article>
</section>
<section class="bg-image-clouds">
  <article>
    <h1 class="fg-grayDark" style="margin-bottom: 45px;">酒店推荐</h1>
    <ul class="sorted-list hotel">
      {% for hotel in package.hotels.all %}
        <li>
          <div class="grid">
            <div class="row cursor-pointer">
              <div>
                <div class="span4">
                  <img src="{{ hotel.image_url }}"/>
                </div>
                <div class="span8">
                  <h2 class="fg-grayDark">{{ hotel.name }}</h2>
                  <p class="fg-grayLight">{{ hotel.summary }}</p>
                  <span class="currency">
                    <strong>&yen; {{ hotel.get_pretty_price }}</strong>
                    <small>/晚</small>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>
  </article>
  <article>
    <h1 class="fg-grayDark" style="margin-bottom: 45px;">机票推荐</h1>
    <ul class="sorted-list flight">
      {% for flight in package.flights.all %}
        <li>
          <div class="grid">
            <div class="row cursor-pointer">
              <div>
                <div class="span4">
                  <img src="{{ flight.image_url }}"/>
                </div>
                <div class="span8">
                  <h2 class="fg-grayDark">{{ flight.name }}</h2>
                  <p class="fg-grayLight">{{ flight.summary }}</p>
                  <span class="currency">
                    <strong>&yen; {{ flight.price }}</strong>
                    <small>/人</small>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>
  </article>
  <a id="order-btn" class="button large submit" href="#">提交意向</a>
  <div class="space-50"></div>
</section>
{% endblock main_content %}

{% block extrajs %}
  <script>
    $(document).ready(function() {
      $('.sorted-list.hotel > li > .grid > .row').on('click', function() {
        $('.sorted-list.hotel .selected').removeClass('selected');
        $(this).children('div').addClass('selected');
      });

      $('.sorted-list.flight > li > .grid > .row').on('click', function() {
        $('.sorted-list.flight .selected').removeClass('selected');
        $(this).children('div').addClass('selected');
      });

      $('#order-btn').on('click', function() {
        var loginUsername = '';
        var loginPhone = '';
        {% if user.is_authenticated %}
          loginUsername = '{{ user.name }}';
          loginPhone = '{{ user.phone }}';
        {% endif %}
        $.Dialog({
          overlay: true,
          shadow: true,
          flat: true,
          width: 1020,
          onShow: function(_dialog) {
            var content = '' +
              '<div class="order-group bg-white">' +
              '  <form action="" method="post">' + "{% csrf_token %}" +
              '    <fieldset>' +
              '      <div class="grid fluid">' +
              '        <div class="row">' +
              '          <div class="span4 offset1">' +
              '            <label class="title" for="">确认入住信息</label>' +
              '          </div>' +
              '          <div class="span7 input-group">' +
              '            <div class="grid fluid">' +
              '              <div class="row">' +
              '                <div class="span5">' +
              '                  <label for="">姓名：</label>' +
              '                  <div class="input-control text" data-role="input-control">' +
              '                    <input type="text" value="' + loginUsername + '">' +
              '                  </div>' +
              '                </div>' +
              '              </div>' +
              '              <div class="row">' +
              '                <div class="span5">' +
              '                  <label for="">手机号：</label>' +
              '                  <div class="input-control text" data-role="input-control">' +
              '                    <input type="text" value="' + loginPhone + '">' +
              '                  </div>' +
              '                </div>' +
              '              </div>' +
              '              <div class="row">' +
              '                <div class="span3">' +
              '                  <label for="">入住日期：</label>' +
              '                  <div class="input-control text" data-role="input-control">' +
              '                    <input type="text">' +
              '                  </div>' +
              '                </div>' +
              '                <div class="span3">' +
              '                  <label for="">离开日期：</label>' +
              '                  <div class="input-control text" data-role="input-control">' +
              '                    <input type="text">' +
              '                  </div>' +
              '                </div>' +
              '              </div>' +
              '            </div>' +
              '          </div>' +
              '        </div>' +
              '        <hr class="separator solid">' +
              '        <div class="row">' +
              '          <div class="span2 offset10">' +
              '            <a class="button large confirm" href="#">确认</a>' +
              '          </div>' +
              '        </div>' +
              '      </div>' +
              '    </fieldset>' +
              '  </form>' +
              '</div>';
            $.Dialog.content(content);
            _dialog.children('.content').attr('style', 'padding: 32px 0 0;');
            $.Metro.initInputs();
          }
        });
      });
    });
  </script>
{% endblock extrajs %}